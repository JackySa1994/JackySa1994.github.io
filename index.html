<!DOCTYPE html>

<script src="https://d3js.org/d3.v5.min.js"></script>

<style> .chart rect {fill: steelblue} 
#tooltip {
    opacity: 0;
    position: absolute;
    text-align: center;
    width:120px; height:80px;
    background: white;
    border:2px;
    border-style: solid;
    border-color: black;
}
</style>

<html>
<h1>Pokemon</h1>

<body onload = "load_data()">
<p> Analysis of the number of <b>Pokemon</b> Across <b>Generations, Types and Attack Powers!</b></p>

<p> This chart currently shows Pokemon across all generations. Click on a bar to explore that <b>Generation</b> further </p>

<p style= "font-size:10px;"></p> Click on <b>Reset Chart</b> to go back to All Pokemons</p>

<style>
    rect{
        cursor: pointer;
    }
</style>

<button type="button" onclick = "reset()">Reset Chart</button>

<svg class="chart" width="1500" height="500">
</svg>

<div id="tooltip" opacity =0></div>

<script>


var data_f = []


async function load_data() {
    data_f = await d3.csv('https://raw.githubusercontent.com/JackySa1994/JackySa1994.github.io/main/pokemon-2.csv')
    chart_generations(data_f)
    ;}

function chart_generations(data_f) {
    var data_g = [1,2,3,4,5,6,7] ;
    var data_g_c = [0,0,0,0,0,0,0] ;


    for (let i = 0; i < 800; i++)
        {gen = data_f[i].generation - 1
         data_g_c[gen] = data_g_c[gen] + 1
        }

    var width = 800;
    var height = 400;
    var margin = 75;
    
    var rect_style_over = {
  	"stroke": "#FF9696",
  	"fill": "#E2E2E2",
  	"cursor": "pointer"}

    var y = d3.scaleLinear()
        .domain([50,170])
        .range([height,0]);

    var x = d3.scaleLinear()
        .domain([0,8])
        .range([0, width]);

    var tooltip = d3.select("#tooltip");

    d3.select("svg")
        .append("g")
        .attr("transform","translate("+margin+","+margin+")")
        .call(d3.axisLeft(y))
        .append("text")

    d3.select("svg")
        .append("g")
        .attr("transform","translate("+margin+","+(height+margin)+")")
        .call(d3.axisBottom(x).tickValues([1,2,3,4,5,6,7]));

    d3.select("svg")
        .append("text")
        .attr("x", margin + (width / 2))             
        .attr("y", margin)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .style("text-decoration", "underline")  
        .text("Number of Pokemon Across Generations");

    d3.select("svg")
        .selectAll("rect")
        .data(data_g_c)
        .enter().append("rect")
        .attr("width",70)
        .attr("height",function(data_g_c) {return height - y(data_g_c); })
        .attr("x",function(data_g,i) {return 1.9 * margin + x(i);})
        .attr("y",function(data_g_c) {return margin + y(data_g_c); })
        .style('fill', '#cba9e5')
        .on("mouseover", function(data_g_c,i) {
            tooltip.style("opacity",1)
                .style("left",(d3.event.pageX)+"px")
                .style("top",(d3.event.pageY)+"px")
                .html("There are " + data_g_c + " " + "generation " + (i + 1) + " Pokemon." + " " + "Click to Explore Further")
            ;})
        .on("mouseout",function(){tooltip.style("opacity",0)})
        .on("click", chart_type);  
    }

function chart_type(data_g_c, i){
    gen = i + 1
    
    var tooltip = d3.select("#tooltip")

    tooltip.style("opacity",0)

    d3.select("svg")
        .remove()

        
    d3.select("body")
        .append("svg")
        .attr("width", 1500)
        .attr("height", 500);

    data_f_new = []

    for (let j = 0; j < 800; j++){
        if (data_f[j].generation == gen)
        {data_f_new.push(data_f[j])};
    };

    data_f = data_f_new

    var data_t = ["water","steel","rock","psychic","poison","normal","ground","grass","ghost","fire","fighting","fairy","electric"
    ,"dragon","dark","bug"]

    var data_t_c = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]

    for (let j = 0; j < data_f.length - 1; j++){
        for (let k = 0; k < data_t.length; k++)
            {if (data_f[j].type1 == data_t[k])
            {data_t_c[k] ++}}}
    

    dataset = []
    for (let j = 0; j < 16; j++){
        point = [data_t[j],data_t_c[j]]
        dataset.push(point)
    }

        
    var width = 800;
    var height = 400;
    var margin = 75;


    var y = d3.scaleLinear()
        .domain([0,30])
        .range([height,0]);

    var x = d3.scaleBand()
        .domain(data_t)
        .range([0,width]);

    
    d3.select("svg")
        .append("g")
        .attr("transform","translate("+margin+","+margin+")")
        .call(d3.axisLeft(y));
    
    d3.select("svg")
        .append("g")
        .attr("transform","translate("+margin+","+(height+margin)+")")
        .call(d3.axisBottom(x).ticks(18));


    d3.select("svg")
        .append("text")
        .attr("x", margin + (width / 2))             
        .attr("y", margin)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .style("text-decoration", "underline")  
        .text("Number of Pokemon Across Types");

    d3.select("svg")
        .selectAll("rect")
        .data(dataset)
        .enter().append("rect")
        .attr('fill', '#cba9e5')
        .attr("width",35)
        .attr("height",function(d) {return height - y(d[1]); })
        .attr("x",function(d) {return 1.10 * margin + x(d[0]); })
        .attr("y",function(d) {return margin + y(d[1]); })
        .on("mouseover", function(d,i) {
            tooltip.style("opacity",1)
                .style("left",(d3.event.pageX)+"px")
                .style("top",(d3.event.pageY)+"px")
                .html("There are " + d[1] + " " + d[0] + " " + "type" + " " + "Pokemon." + " " + "Click to Explore Further")})
        .on("mouseout",function(){tooltip.style("opacity",0)}) 
        .on("click", chart_atk);  

}


function chart_atk(d,i){
    var tooltip = d3.select("#tooltip")

    tooltip.style("opacity",0)

    d3.select("svg")
        .remove()

    d3.select("body")
        .append("svg")
        .attr("width", 1500)
        .attr("height", 500);


    new_data_f  = []
    a = []
    for (let j = 0; j < data_f.length; j++) {
        if (data_f[j].type1 == d[0]) 
        {new_data_f.push(data_f[j].attack)}
    }
    data_f = new_data_f
    
    xbands = ["0-20","21-40","41-60","61-80","81-100","101-120","121-140","141-160","161-180","181-200"]
    xbands_c = [0,0,0,0,0,0,0,0,0,0]
    for (let j = 0; j<data_f.length; j++) {
        atk = data_f[j]
        pos = Math.ceil(atk/20)
        xbands_c[pos] +=1
    }

    data = []

    for (let j = 0; j < 10; j++){
        point = [xbands[j],xbands_c[j]]
        data.push(point)
    }

    var width = 800;
    var height = 400;
    var margin = 75;


    var y = d3.scaleLinear()
        .domain([0,16])
        .range([height,0]);

    var x = d3.scaleBand()
        .domain(xbands)
        .range([0,width]);

    
    d3.select("svg")
        .append("g")
        .attr("transform","translate("+margin+","+margin+")")
        .call(d3.axisLeft(y));
    
    d3.select("svg")
        .append("g")
        .attr("transform","translate("+margin+","+(height+margin)+")")
        .call(d3.axisBottom(x));


    d3.select("svg")
        .append("text")
        .attr("x", margin + (width / 2))             
        .attr("y", margin)
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .style("text-decoration", "underline")  
        .text("Number of Pokemon Across Attack Powers");

    d3.select("svg")
        .selectAll("rect")
        .data(data)
        .enter().append("rect")
        .attr('fill', '#cba9e5')
        .attr("width",60)
        .attr("height",function(d) {return height - y(d[1]); })
        .attr("x",function(d) {return 1.1*margin + x(d[0]); })
        .attr("y",function(d) {return margin + y(d[1]); });

}

function reset(){
    location.reload();
}

</script>
</body>

</html>





